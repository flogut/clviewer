image: maven:3.5.3-jdk-8

stages:
 - test
 - build
 - deploy

before_script:
  - apt-get update
  - apt-get install --no-install-recommends -y openjfx
  - apt-get clean
  - rm -f /var/lib/apt/lists/*_dists_*

test:
  stage: test
  script: mvn test

build:
  stage: build
  script: mvn clean compile
  artifacts:
    paths:
    - detekt/
    expire_in: 1 week
    when: always

jar:
  stage: deploy
  script: mvn package
  artifacts:
    paths:
    - target/*-jar-with-dependencies.jar
    expire_in: 1 week
  when: manual

native:
  stage: deploy
  script: mvn jfx:native
  artifacts:
    paths:
    - target/jfx/native/*.exe
    expire_in: 1 week
  when: manual